<div class="row">
  <div class="span6 offset3">
    <%= form_for @gadget, html: {multipart: true} do |f| %>
    	<%= render 'shared/error_messages', object: f.object %>
      <% if f.object.new_record? %>
	    	<div class="field">
	    		<%= f.label :gadget_type %><br />
			    <%= collection_select(
			    	:gadget, :gadget_type_id, @gadget_types, 
			    	:id, :name, prompt:true) %>
			  </div>
			  <div><%= f.hidden_field :app_id %></div>
		  <% end %>
		  <div class="field">
		    <%= f.label :label %><br />
		    <%= f.text_field :label %>
		  </div>
		  <div class="field">
		    <%= f.label :description %><br />
		    <%= f.text_area :description, rows: 10 %>
		  </div>
		  <div class="field">
		  	<%= f.label :icon, 'Icon (128x128 pixel .png recommended)' %><br />
		  	<% if @gadget.icon.nil? and !f.object.new_record? %>
 					<%= image_tag 'gadgets/'+@gadget.type+'.png' %>
 				<% else %>
		  		<%= image_tag @gadget.icon.thumb('128x128').url if @gadget.icon_uid %>
		  	<% end %>
		  	<%= f.file_field :icon %>
				<%= f.hidden_field :retained_icon %>
		  </div>
      <%= f.submit "Save changes", class: "btn btn-large btn-primary" %>
      <% if f.object.new_record? %>
      	<%= link_to "Cancel", @gadget.app %>
      <% else %>
      	<%= link_to "Cancel", @gadget %>
      <% end %>
    <% end %>
  </div>
</div>
